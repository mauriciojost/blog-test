<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Mauricio Jost">
  <meta name="theme-color" content="#284a5e">
  <title>Measuring the Performance of Anything In Scala</title>
  <meta name="description" content="Why benchmarking?">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2017/04/19/benchmarking-in-scala.html">
  <link rel="alternate" type="application/rss+xml" title="Mauricio Jost" href="http://localhost:4000/feed.xml">
</head>

<body>
	<div id="container">
		<div id="row">
			<header id="sidebar">
  <a href="/"/>
    <!--<img src="/images/giraffe.png" class="avatar" alt="Cartoon giraffe" />-->
  </a>

  <h1>
    <strong>I am Mauricio</strong><br />and these are my two cents</h1> 

  <nav class="site-nav vspace">
    <a href="/" class="navlink">Blog</a>
    <span style="font-size: 10px;">&nbsp;&bull;&nbsp;</span>
    <a href="/archives" class="navlink">Archives</a>
    <span style="font-size: 10px;">&nbsp;&bull;&nbsp;</span>
    <a href="/about" class="navlink">About</a>
  </nav>

  <ul class="icons vspace">
    <li><a href="https://www.linkedin.com/in/mauriciojost/" class="icon fa-linkedin" title="Linkedin profile"><span class="label">Linkedin</span></a></li>
    <li><a href="https://github.com/mauriciojost" class="icon fa-github" title="Github profile"><span class="label">Github</span></a></li>
    <li><a href="http://stackoverflow.com/users/1554927/mauriciojost" class="icon fa-stack-overflow" title="Stackoverflow profile"><span class="label">Stack Overflow</span></a></li>
  </ul>
</header>

			<section id="page-content">
				<div id="content">
					<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <p class="post-meta"><time datetime="2017-04-19T00:00:00+02:00" itemprop="datePublished">Apr 19, 2017</time></p>
    <h1 class="post-title" itemprop="name headline">Measuring the Performance of Anything In Scala</h1>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="why-benchmarking">Why benchmarking?</h2>

<p>Coding consciously and the use of code reviews are of great importance when it comes to writing clean and efficient code.
But sometimes I feel like I need stronger proofs to go one way or another, specially when I don&#39;t really know what is 
happening under the JVM hood.</p>

<p>A number describing the current status of your implementation will let you firstly gain awareness, 
secondly decide if improvement is worth the investment, 
and finally measure the improvement of your change. But it is not so easy...</p>

<!--more-->

<h2 id="what-is-the-problem-with-it">What is the problem with it?</h2>

<p>When it comes to performance of an algorithm, we can get such metric by doing <strong>benchmarking</strong>. </p>

<blockquote>
<p><em>What can be so complicated about it? Just launch the algorithm many times and measure its execution time, and voila!!!</em></p>
</blockquote>

<p>Nope, benchmarking is not so trivial, specially on top of JVM. Scala by itself applies more than 
<a href="https://wiki.scala-lang.org/display/SIW/Overview+of+Compiler+Phases">15 phases</a> when 
compiling trying to optimize the algorithm, and the JVM can also apply very clever optimizations at run time, leading to a (very) fooled conclusion.</p>

<p>For instance, try to explain why the comparative benchmark set
<a href="https://mauriciojost.github.io/scala-benchmark/">org.mauritania.minibenchmark.catalog.IdentityTricky</a> 
below (the suspiciously even one) yields such unexpected results for 
<a href="https://github.com/mauriciojost/scala-benchmark/blob/master/src/main/scala/org/mauritania/minibenchmark/catalog/IdentityTricky.scala">these very different algorithms</a>. 
Found the reason?</p>

<p><a href="https://github.com/mauriciojost/scala-benchmark/"><img src="https://browshot.com/screenshot/image/56100717?&width=5500&height=3500" alt="Project"></a></p>

<h2 id="and-the-solution">And the solution?</h2>

<p>The one I recommend is to use <a href="http://openjdk.java.net/projects/code-tools/jmh/">JMH</a>, the harness for Java benchmarking that is 
exploitable from Scala thanks to <a href="https://github.com/ktoso/sbt-jmh">sbt-jmh</a>.</p>

<h2 id="how-to-get-started-right-now">How to get started right now?</h2>

<p><strong>I&#39;ve set up a <a href="https://github.com/mauriciojost/scala-benchmark">project github/scala-benchmark</a> which 
renders <a href="https://mauriciojost.github.io/scala-benchmark/">visual reports</a> that GitHub can display via GitHub pages.</strong></p>

<p>Also if you want to know more, I really recommend <a href="http://tutorials.jenkov.com/java-performance/jmh.html">this read about JMH</a>.</p>

<p><strong>Won&#39;t you benchmark anything?</strong></p>

  </div>

  <div itemprop="keywords">
    Tags:
    
      <a href="http://www.google.com/search?q=scala&btnI=I%27m%20feeling%20lucky">scala</a>, 
    
      <a href="http://www.google.com/search?q=performance&btnI=I%27m%20feeling%20lucky">performance</a>, 
    
      <a href="http://www.google.com/search?q=benchmark&btnI=I%27m%20feeling%20lucky">benchmark</a>, 
    
      <a href="http://www.google.com/search?q=api&btnI=I%27m%20feeling%20lucky">api</a>, 
    
      <a href="http://www.google.com/search?q=collections&btnI=I%27m%20feeling%20lucky">collections</a>, 
    
      <a href="http://www.google.com/search?q=jmh&btnI=I%27m%20feeling%20lucky">jmh</a>
    
  </div>
</article>





<div id="disqus_thread"></div>
<script type="text/javascript">
        var disqus_shortname = 'mauriciojost-github-io';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




				</div>
			</section>
		</div>
	</div>
	<script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
